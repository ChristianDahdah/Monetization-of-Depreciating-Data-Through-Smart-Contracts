const Web3 = require('web3');
var Tx = require('ethereumjs-tx');
let fs = require("fs");



// Web3 Initialisation
const provider = 'http://192.168.33.115:8545';
console.log("******************************************");
console.log("Using provider : " + provider);
console.log("******************************************");
var web3 = new Web3(new Web3.providers.HttpProvider(provider))


//////////////////////////////////////Account info for deployment///////////////////////////////////////////////////
var account1= "0xfe3b557e8fb62b89f4916b721be55ceb828dbd73";
var key1 =new Buffer.from('8f2a55949038a9610f50fb23b5883af3b4ecb3c3bb792cbcefbd1542c692be63','hex');
/////////////////////////////////////////////////////////////////////////////////////////:

// Read the compiled contract code
// Compile with
// solc SampleContract.sol --combined-json abi,asm,ast,bin,bin-runtime,clone-bin,devdoc,interface,opcodes,srcmap,srcmap-runtime,userdoc > contracts.json
// let source = fs.readFileSync("/home/rsx14/IdeaProjects/PIR/Solidity/contracts.json");
// let contracts = JSON.parse(source)["contracts"];

// ABI description as JSON structure

let abi = [{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":true,"internalType":"address","name":"client","type":"address"},{"indexed":false,"internalType":"bytes32","name":"encodedKeyHash","type":"bytes32"}],"name":"encodedKeyHash","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":true,"internalType":"address","name":"client","type":"address"},{"indexed":false,"internalType":"bytes32","name":"encryptedEncodedKey","type":"bytes32"}],"name":"encryptedEncodedKeyEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":true,"internalType":"address","name":"client","type":"address"},{"indexed":false,"internalType":"bytes32","name":"keyDecoder","type":"bytes32"}],"name":"keyDecoder","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":true,"internalType":"address","name":"client","type":"address"},{"indexed":false,"internalType":"uint256","name":"fund","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"time","type":"uint256"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH1","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH2","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH3","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH4","type":"bytes32"}],"name":"newClient","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":true,"internalType":"address","name":"provider","type":"address"},{"indexed":false,"internalType":"uint256","name":"initialPrice","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"insuranceDeposit","type":"uint256"},{"indexed":false,"internalType":"uint64","name":"minimumData","type":"uint64"},{"indexed":false,"internalType":"uint64","name":"deployTime","type":"uint64"},{"indexed":false,"internalType":"uint64","name":"endTime","type":"uint64"},{"indexed":false,"internalType":"uint8","name":"depreciationType","type":"uint8"},{"indexed":false,"internalType":"string","name":"description","type":"string"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH1","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH2","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH3","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"publicKeyDH4","type":"bytes32"}],"name":"newDataReference","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":false,"internalType":"string","name":"spaceObject","type":"string"}],"name":"newTLE","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":false,"internalType":"bytes32","name":"referenceKey","type":"bytes32"}],"name":"referenceKey","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"_referenceId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"funds","type":"uint256"}],"name":"withdrawFundsEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"referenceId","type":"uint256"},{"indexed":true,"internalType":"address","name":"client","type":"address"},{"indexed":false,"internalType":"uint256","name":"funds","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"time","type":"uint256"}],"name":"withdrawRefund","type":"event"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"TLEs","outputs":[{"internalType":"string","name":"spaceObject","type":"string"},{"internalType":"bytes25","name":"TLE1","type":"bytes25"},{"internalType":"bytes24","name":"TLE2","type":"bytes24"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"},{"internalType":"bytes32","name":"_publicKeyDH1","type":"bytes32"},{"internalType":"bytes32","name":"_publicKeyDH2","type":"bytes32"},{"internalType":"bytes32","name":"_publicKeyDH3","type":"bytes32"},{"internalType":"bytes32","name":"_publicKeyDH4","type":"bytes32"}],"name":"buyReference","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_initialPrice","type":"uint256"},{"internalType":"uint64","name":"_minimumData","type":"uint64"},{"internalType":"uint64","name":"_referenceDuration","type":"uint64"},{"internalType":"uint8","name":"_depreciationType","type":"uint8"},{"internalType":"string","name":"_description","type":"string"},{"internalType":"bytes32","name":"_publicKeyDH1","type":"bytes32"},{"internalType":"bytes32","name":"_publicKeyDH2","type":"bytes32"},{"internalType":"bytes32","name":"_publicKeyDH3","type":"bytes32"},{"internalType":"bytes32","name":"_publicKeyDH4","type":"bytes32"}],"name":"createDataReference","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"getClientDisputes","outputs":[{"internalType":"address[]","name":"","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"getClients","outputs":[{"internalType":"address[]","name":"","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceKey","type":"uint256"}],"name":"getKeyDecoder","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"getNumberOfData","outputs":[{"internalType":"uint128","name":"numberOfData","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"getReferenceCurrentPrice","outputs":[{"internalType":"uint256","name":"price","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"getTLEs","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"},{"components":[{"internalType":"string","name":"spaceObject","type":"string"},{"internalType":"bytes25","name":"TLE1","type":"bytes25"},{"internalType":"bytes24","name":"TLE2","type":"bytes24"}],"internalType":"struct TLE_Contract.structTLE[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"raiseDispute","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"},{"internalType":"bytes32","name":"_encodedKeyHash","type":"bytes32"}],"name":"setEncodedHashedKey","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"},{"internalType":"address","name":"_client","type":"address"},{"internalType":"bytes32","name":"_encryptedEncodedKey","type":"bytes32"}],"name":"setEncryptedEncodedKey","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"},{"internalType":"address","name":"_client","type":"address"},{"internalType":"bytes32","name":"_keyDecoder","type":"bytes32"}],"name":"setKeyDecoder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"},{"internalType":"bytes32","name":"_referenceKey","type":"bytes32"}],"name":"setReferenceKey","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"},{"internalType":"string","name":"_spaceObject","type":"string"},{"internalType":"bytes25","name":"_TLE1","type":"bytes25"},{"internalType":"bytes24","name":"_TLE2","type":"bytes24"}],"name":"setTLE","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_referenceId","type":"uint256"}],"name":"withdrawFunds","outputs":[],"stateMutability":"nonpayable","type":"function"}]


//[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}]



// Smart contract EVM bytecode as hex

let code = '0x' + "608060405234801561001057600080fd5b50613552806100206000396000f3fe6080604052600436106100f35760003560e01c80638656bbe91161008a578063b14b678711610059578063b14b678714610330578063ca90fee514610359578063e3752bbe14610397578063ed957100146103d4576100f3565b80638656bbe91461026457806392a0294f1461028d578063a5c1674e146102ca578063ac231a9814610307576100f3565b8063560abdd1116100c6578063560abdd1146101c657806371944180146101e25780637b30d4fd1461020b5780637d918a2514610227576100f3565b8063155dd5ee146100f857806320a6bde91461012157806323bf42621461014a57806342dd519c14610189575b600080fd5b34801561010457600080fd5b5061011f600480360381019061011a9190612ac9565b610411565b005b34801561012d57600080fd5b5061014860048036038101906101439190612b41565b6105d7565b005b34801561015657600080fd5b50610171600480360381019061016c9190612c6f565b61075a565b60405161018093929190613099565b60405180910390f35b34801561019557600080fd5b506101b060048036038101906101ab9190612ac9565b610850565b6040516101bd9190612fef565b60405180910390f35b6101e060048036038101906101db9190612cab565b610974565b005b3480156101ee57600080fd5b5061020960048036038101906102049190612bf4565b610d03565b005b61022560048036038101906102209190612b7d565b610f3d565b005b34801561023357600080fd5b5061024e60048036038101906102499190612ac9565b611252565b60405161025b91906130d7565b60405180910390f35b34801561027057600080fd5b5061028b60048036038101906102869190612b41565b611297565b005b34801561029957600080fd5b506102b460048036038101906102af9190612ac9565b6113a7565b6040516102c1919061302c565b60405180910390f35b3480156102d657600080fd5b506102f160048036038101906102ec9190612ac9565b611475565b6040516102fe9190613011565b60405180910390f35b34801561031357600080fd5b5061032e60048036038101906103299190612af2565b611917565b005b34801561033c57600080fd5b5061035760048036038101906103529190612af2565b611b98565b005b34801561036557600080fd5b50610380600480360381019061037b9190612ac9565b611c6f565b60405161038e929190613047565b60405180910390f35b3480156103a357600080fd5b506103be60048036038101906103b99190612ac9565b61211c565b6040516103cb9190612fef565b60405180910390f35b3480156103e057600080fd5b506103fb60048036038101906103f69190612ac9565b61237c565b60405161040891906130f2565b60405180910390f35b806000818154811061041f57fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461048857600080fd5b601e6000838154811061049757fe5b90600052602060002090600d020160050160189054906101000a900467ffffffffffffffff160167ffffffffffffffff1642116104d357600080fd5b6000801b600083815481106104e457fe5b90600052602060002090600d020160040154141561050157600080fd5b600080838154811061050f57fe5b90600052602060002090600d0201600201549050600080848154811061053157fe5b90600052602060002090600d0201600201819055506000811161055357600080fd5b3373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050158015610599573d6000803e3d6000fd5b50827f5ab32616397610e8c52d9f2c536a03778db8878dda9c977d99c05bcb5666dd90826040516105ca91906130f2565b60405180910390a2505050565b8160008082815481106105e657fe5b90600052602060002090600d020160080160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541161063f57600080fd5b6000801b6000848154811061065057fe5b90600052602060002090600d0201600b0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205414156107065781600084815481106106b357fe5b90600052602060002090600d0201600b0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b3373ffffffffffffffffffffffffffffffffffffffff16837fc9a5303ca56727b24e4955597b9bb74dd9bc6462dbad79d63dd393b1b7e5d1068460405161074d919061302c565b60405180910390a3505050565b6001602052816000526040600020818154811061077357fe5b906000526020600020906003020160009150915050806000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156108205780601f106107f557610100808354040283529160200191610820565b820191906000526020600020905b81548152906001019060200180831161080357829003601f168201915b5050505050908060010160009054906101000a900460381b908060020160009054906101000a900460401b905083565b6060816000818154811061086057fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146108c957600080fd5b600083815481106108d657fe5b90600052602060002090600d020160070180548060200260200160405190810160405280929190818152602001828054801561096757602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001906001019080831161091d575b5050505050915050919050565b61097c61276a565b898160000181815250503481602001818152505034816040018181525050888160a0019067ffffffffffffffff16908167ffffffffffffffff16815250508681610120019060ff16908160ff1681525050428160e0019067ffffffffffffffff16908167ffffffffffffffff168152505042880181610100019067ffffffffffffffff16908167ffffffffffffffff16815250504267ffffffffffffffff1681610100015167ffffffffffffffff1611610a3557600080fd5b33816060019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505060008190806001815401808255809150506001900390600052602060002090600d020160009091909190915060008201518160000155602082015181600101556040820151816002015560608201518160030160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506080820151816004015560a08201518160050160006101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060c08201518160050160086101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060e08201518160050160106101000a81548167ffffffffffffffff021916908367ffffffffffffffff1602179055506101008201518160050160186101000a81548167ffffffffffffffff021916908367ffffffffffffffff1602179055506101208201518160060160006101000a81548160ff021916908360ff160217905550610140820151816007019080519060200190610c0492919061283a565b5061016082015181600a0160006101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff16021790555061018082015181600a0160106101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff16021790555050503373ffffffffffffffffffffffffffffffffffffffff166001600080549050037f072e5f27c7f8e793354f6112b37790216274b3682774cb5143c8d650502a4a308c348d428761010001518e8e8e8e8e8e604051610cef9b9a99989796959493929190613197565b60405180910390a350505050505050505050565b8360008181548110610d1157fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610d7a57600080fd5b610d826128c4565b84816000018190525083816020019066ffffffffffffff1916908166ffffffffffffff19168152505082816040019067ffffffffffffffff1916908167ffffffffffffffff191681525050600160008781526020019081526020016000208190806001815401808255809150506001900390600052602060002090600302016000909190919091506000820151816000019080519060200190610e269291906128fa565b5060208201518160010160006101000a81548178ffffffffffffffffffffffffffffffffffffffffffffffffff021916908360381c021790555060408201518160020160006101000a81548177ffffffffffffffffffffffffffffffffffffffffffffffff021916908360401c0217905550505060008681548110610ea757fe5b90600052602060002090600d0201600501600881819054906101000a900467ffffffffffffffff168092919060010191906101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555050857f0d24b8ac995fa8eca2b46e0246413d6123831e152dfb6a0cbd71df864ba2192b86604051610f2d9190613077565b60405180910390a2505050505050565b846000801b60008281548110610f4f57fe5b90600052602060002090600d02016004015414610f6b57600080fd5b60008181548110610f7857fe5b90600052602060002090600d020160050160189054906101000a900467ffffffffffffffff1667ffffffffffffffff164210610fb357600080fd5b6000610fbe8261237c565b905080341015610fcd57600080fd5b60008281548110610fda57fe5b90600052602060002090600d020160000154341115610ff857600080fd5b600015156000888154811061100957fe5b90600052602060002090600d020160090160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615151461107157600080fd5b6000878154811061107e57fe5b90600052602060002090600d0201600701339080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600088815481106110ff57fe5b90600052602060002090600d020160090160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550346000888154811061117257fe5b90600052602060002090600d020160080160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555034600088815481106111d257fe5b90600052602060002090600d0201600201600082825401925050819055503373ffffffffffffffffffffffffffffffffffffffff16877fc32bb49cc1f5566dbd62cf916dd16565e9de6a88342878445ccdc262136d850434428a8a8a8a60405161124196959493929190613136565b60405180910390a350505050505050565b600080828154811061126057fe5b90600052602060002090600d020160050160089054906101000a900467ffffffffffffffff1667ffffffffffffffff169050919050565b81600081815481106112a557fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461130e57600080fd5b6000801b6000848154811061131f57fe5b90600052602060002090600d02016004015414801561134157506000801b8214155b156113a257816000848154811061135457fe5b90600052602060002090600d020160040181905550827f2a1b289fe6fe9bd89c1cfbbed506798801b402cafb0a3d93c29cb9c8aafed92083604051611399919061302c565b60405180910390a25b505050565b60008160008082815481106113b857fe5b90600052602060002090600d020160080160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541161141157600080fd5b6000838154811061141e57fe5b90600052602060002090600d0201600c0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054915050919050565b600081600080828154811061148657fe5b90600052602060002090600d020160080160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054116114df57600080fd5b60008084815481106114ed57fe5b90600052602060002090600d020160080160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050806000858154811061154c57fe5b90600052602060002090600d020160020154101561156957600080fd5b6000801b6000858154811061157a57fe5b90600052602060002090600d0201600c0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205414156115e3576115d9848261259c565b6001925050611911565b6000801b600085815481106115f457fe5b90600052602060002090600d020160040154146118b257600080858154811061161957fe5b90600052602060002090600d0201600c0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546000868154811061167557fe5b90600052602060002090600d0201600401541890506000858154811061169757fe5b90600052602060002090600d0201600b0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054816040516020016116f7919061302c565b604051602081830303815290604052805190602001201461179f576000858154811061171f57fe5b90600052602060002090600d0201600a0160109054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff166000868154811061176c57fe5b90600052602060002090600d0201600101548161178557fe5b0482019150611794858361259c565b600193505050611911565b600085815481106117ac57fe5b90600052602060002090600d020160050160009054906101000a900467ffffffffffffffff1667ffffffffffffffff16600086815481106117e957fe5b90600052602060002090600d020160050160089054906101000a900467ffffffffffffffff1667ffffffffffffffff1610156118ac576000858154811061182c57fe5b90600052602060002090600d0201600a0160109054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff166000868154811061187957fe5b90600052602060002090600d0201600101548161189257fe5b04820191506118a1858361259c565b600193505050611911565b5061190b565b600084815481106118bf57fe5b90600052602060002090600d020160050160189054906101000a900467ffffffffffffffff1667ffffffffffffffff1642111561190a57611900848261259c565b6001925050611911565b5b60009250505b50919050565b826000818154811061192557fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461198e57600080fd5b600080858154811061199c57fe5b90600052602060002090600d020160080160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541115611b92576000801b60008581548110611a0257fe5b90600052602060002090600d0201600c0160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054148015611a6157506000801b8214155b15611b91578160008581548110611a7457fe5b90600052602060002090600d0201600c0160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555060008481548110611ad357fe5b90600052602060002090600d0201600a01601081819054906101000a90046fffffffffffffffffffffffffffffffff168092919060010191906101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff160217905550508273ffffffffffffffffffffffffffffffffffffffff16847f557b07a87337236272a12c29e39bd292a192d7c1811cc6994635d23284e935df84604051611b88919061302c565b60405180910390a35b5b50505050565b8260008181548110611ba657fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614611c0f57600080fd5b6000801b8214611c69578273ffffffffffffffffffffffffffffffffffffffff16847fd57e7ea23bb50dbe8316bec30809240f566976ab1b1e4e37e76c7bb3e0b645f084604051611c60919061302c565b60405180910390a35b50505050565b6000606060008381548110611c8057fe5b90600052602060002090600d020160050160189054906101000a900467ffffffffffffffff1667ffffffffffffffff1642108015611cde57506000801b60008481548110611cca57fe5b90600052602060002090600d020160040154145b15611f8d576000801b60008481548110611cf457fe5b90600052602060002090600d0201600c0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054141580611db9575060008381548110611d5857fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b611dc257600080fd5b60008381548110611dcf57fe5b90600052602060002090600d0201600c0160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546001600085815260200190815260200160002080805480602002602001604051908101604052809291908181526020016000905b82821015611f7e5783829060005260206000209060030201604051806060016040529081600082018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611f0e5780601f10611ee357610100808354040283529160200191611f0e565b820191906000526020600020905b815481529060010190602001808311611ef157829003601f168201915b505050505081526020016001820160009054906101000a900460381b66ffffffffffffff191666ffffffffffffff191681526020016002820160009054906101000a900460401b67ffffffffffffffff191667ffffffffffffffff19168152505081526020019060010190611e52565b50505050905091509150612117565b60008381548110611f9a57fe5b90600052602060002090600d0201600401546001600085815260200190815260200160002080805480602002602001604051908101604052809291908181526020016000905b8282101561210c5783829060005260206000209060030201604051806060016040529081600082018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561209c5780601f106120715761010080835404028352916020019161209c565b820191906000526020600020905b81548152906001019060200180831161207f57829003601f168201915b505050505081526020016001820160009054906101000a900460381b66ffffffffffffff191666ffffffffffffff191681526020016002820160009054906101000a900460401b67ffffffffffffffff191667ffffffffffffffff19168152505081526020019060010190611fe0565b505050509050915091505b915091565b6060816000818154811061212c57fe5b90600052602060002090600d020160030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461219557600080fd5b60008084815481106121a357fe5b90600052602060002090600d0201600a0160009054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16905060608167ffffffffffffffff811180156121fe57600080fd5b5060405190808252806020026020018201604052801561222d5781602001602082028036833780820191505090505b509050600080600090505b6000878154811061224557fe5b90600052602060002090600d02016007018054905081101561236f576000878154811061226e57fe5b90600052602060002090600d0201600701818154811061228a57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16915060008088815481106122c557fe5b90600052602060002090600d020160080160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541415612362578183828151811061232757fe5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250505b8080600101915050612238565b5081945050505050919050565b6000806000838154811061238c57fe5b90600052602060002090600d020160000154905060008084815481106123ae57fe5b90600052602060002090600d020160060160009054906101000a900460ff16905060018160ff1614156124a85760008085815481106123e957fe5b90600052602060002090600d020160050160109054906101000a900467ffffffffffffffff166000868154811061241c57fe5b90600052602060002090600d020160050160189054906101000a900467ffffffffffffffff160367ffffffffffffffff169050600080868154811061245d57fe5b90600052602060002090600d020160050160109054906101000a900467ffffffffffffffff1667ffffffffffffffff1642039050818185028161249c57fe5b04840393505050612592565b60028160ff1614156125915760008085815481106124c257fe5b90600052602060002090600d020160050160109054906101000a900467ffffffffffffffff16600086815481106124f557fe5b90600052602060002090600d020160050160189054906101000a900467ffffffffffffffff160367ffffffffffffffff169050600080868154811061253657fe5b90600052602060002090600d020160050160109054906101000a900467ffffffffffffffff1667ffffffffffffffff164203905083828286600202028161257957fe5b0483840283848802028161258957fe5b040301935050505b5b8192505050919050565b80600083815481106125aa57fe5b90600052602060002090600d02016002015410156125c757600080fd5b600082815481106125d457fe5b90600052602060002090600d0201600a01600081819054906101000a90046fffffffffffffffffffffffffffffffff168092919060010191906101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff16021790555050600080838154811061265057fe5b90600052602060002090600d020160080160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555080600083815481106126b057fe5b90600052602060002090600d0201600201600082825403925050819055503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050158015612714573d6000803e3d6000fd5b503373ffffffffffffffffffffffffffffffffffffffff16827f54cd3e4964cbbb07875e24bd38c626e4572701f70d0992629dfbad3a0a6597ec834260405161275e92919061310d565b60405180910390a35050565b604051806101a00160405280600081526020016000815260200160008152602001600073ffffffffffffffffffffffffffffffffffffffff16815260200160008019168152602001600067ffffffffffffffff168152602001600067ffffffffffffffff168152602001600067ffffffffffffffff168152602001600067ffffffffffffffff168152602001600060ff1681526020016060815260200160006fffffffffffffffffffffffffffffffff16815260200160006fffffffffffffffffffffffffffffffff1681525090565b8280548282559060005260206000209081019282156128b3579160200282015b828111156128b25782518260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055509160200191906001019061285a565b5b5090506128c0919061297a565b5090565b604051806060016040528060608152602001600066ffffffffffffff19168152602001600067ffffffffffffffff191681525090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061293b57805160ff1916838001178555612969565b82800160010185558215612969579182015b8281111561296857825182559160200191906001019061294d565b5b50905061297691906129bd565b5090565b6129ba91905b808211156129b657600081816101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905550600101612980565b5090565b90565b6129df91905b808211156129db5760008160009055506001016129c3565b5090565b90565b6000813590506129f18161347b565b92915050565b600081359050612a0681613492565b92915050565b600081359050612a1b816134a9565b92915050565b600081359050612a30816134c0565b92915050565b600082601f830112612a4757600080fd5b8135612a5a612a5582613276565b613249565b91508082526020830160208301858383011115612a7657600080fd5b612a81838284613428565b50505092915050565b600081359050612a99816134d7565b92915050565b600081359050612aae816134ee565b92915050565b600081359050612ac381613505565b92915050565b600060208284031215612adb57600080fd5b6000612ae984828501612a8a565b91505092915050565b600080600060608486031215612b0757600080fd5b6000612b1586828701612a8a565b9350506020612b26868287016129e2565b9250506040612b3786828701612a21565b9150509250925092565b60008060408385031215612b5457600080fd5b6000612b6285828601612a8a565b9250506020612b7385828601612a21565b9150509250929050565b600080600080600060a08688031215612b9557600080fd5b6000612ba388828901612a8a565b9550506020612bb488828901612a21565b9450506040612bc588828901612a21565b9350506060612bd688828901612a21565b9250506080612be788828901612a21565b9150509295509295909350565b60008060008060808587031215612c0a57600080fd5b6000612c1887828801612a8a565b945050602085013567ffffffffffffffff811115612c3557600080fd5b612c4187828801612a36565b9350506040612c5287828801612a0c565b9250506060612c63878288016129f7565b91505092959194509250565b60008060408385031215612c8257600080fd5b6000612c9085828601612a8a565b9250506020612ca185828601612a8a565b9150509250929050565b60008060008060008060008060006101208a8c031215612cca57600080fd5b6000612cd88c828d01612a8a565b9950506020612ce98c828d01612a9f565b9850506040612cfa8c828d01612a9f565b9750506060612d0b8c828d01612ab4565b96505060808a013567ffffffffffffffff811115612d2857600080fd5b612d348c828d01612a36565b95505060a0612d458c828d01612a21565b94505060c0612d568c828d01612a21565b93505060e0612d678c828d01612a21565b925050610100612d798c828d01612a21565b9150509295985092959850929598565b6000612d958383612db5565b60208301905092915050565b6000612dad8383612f63565b905092915050565b612dbe81613341565b82525050565b6000612dcf826132c2565b612dd981856132fd565b9350612de4836132a2565b8060005b83811015612e15578151612dfc8882612d89565b9750612e07836132e3565b925050600181019050612de8565b5085935050505092915050565b6000612e2d826132cd565b612e37818561330e565b935083602082028501612e49856132b2565b8060005b85811015612e855784840389528151612e668582612da1565b9450612e71836132f0565b925060208a01995050600181019050612e4d565b50829750879550505050505092915050565b612ea081613353565b82525050565b612eaf8161335f565b82525050565b612ebe8161335f565b82525050565b612ecd8161338b565b82525050565b612edc8161338b565b82525050565b612eeb816133b7565b82525050565b6000612efc826132d8565b612f06818561331f565b9350612f16818560208601613437565b612f1f8161346a565b840191505092915050565b6000612f35826132d8565b612f3f8185613330565b9350612f4f818560208601613437565b612f588161346a565b840191505092915050565b60006060830160008301518482036000860152612f808282612ef1565b9150506020830151612f956020860182612ec4565b506040830151612fa86040860182612ea6565b508091505092915050565b612fbc816133c1565b82525050565b612fcb816133fd565b82525050565b612fda81613407565b82525050565b612fe98161341b565b82525050565b600060208201905081810360008301526130098184612dc4565b905092915050565b60006020820190506130266000830184612e97565b92915050565b60006020820190506130416000830184612ee2565b92915050565b600060408201905061305c6000830185612ee2565b818103602083015261306e8184612e22565b90509392505050565b600060208201905081810360008301526130918184612f2a565b905092915050565b600060608201905081810360008301526130b38186612f2a565b90506130c26020830185612ed3565b6130cf6040830184612eb5565b949350505050565b60006020820190506130ec6000830184612fb3565b92915050565b60006020820190506131076000830184612fc2565b92915050565b60006040820190506131226000830185612fc2565b61312f6020830184612fc2565b9392505050565b600060c08201905061314b6000830189612fc2565b6131586020830188612fc2565b6131656040830187612ee2565b6131726060830186612ee2565b61317f6080830185612ee2565b61318c60a0830184612ee2565b979650505050505050565b6000610160820190506131ad600083018e612fc2565b6131ba602083018d612fc2565b6131c7604083018c612fd1565b6131d4606083018b612fd1565b6131e1608083018a612fd1565b6131ee60a0830189612fe0565b81810360c08301526132008188612f2a565b905061320f60e0830187612ee2565b61321d610100830186612ee2565b61322b610120830185612ee2565b613239610140830184612ee2565b9c9b505050505050505050505050565b6000604051905081810181811067ffffffffffffffff8211171561326c57600080fd5b8060405250919050565b600067ffffffffffffffff82111561328d57600080fd5b601f19601f8301169050602081019050919050565b6000819050602082019050919050565b6000819050602082019050919050565b600081519050919050565b600081519050919050565b600081519050919050565b6000602082019050919050565b6000602082019050919050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b600061334c826133dd565b9050919050565b60008115159050919050565b60007fffffffffffffffffffffffffffffffffffffffffffffffff000000000000000082169050919050565b60007fffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000082169050919050565b6000819050919050565b60006fffffffffffffffffffffffffffffffff82169050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600067ffffffffffffffff82169050919050565b600060ff82169050919050565b82818337600083830152505050565b60005b8381101561345557808201518184015260208101905061343a565b83811115613464576000848401525b50505050565b6000601f19601f8301169050919050565b61348481613341565b811461348f57600080fd5b50565b61349b8161335f565b81146134a657600080fd5b50565b6134b28161338b565b81146134bd57600080fd5b50565b6134c9816133b7565b81146134d457600080fd5b50565b6134e0816133fd565b81146134eb57600080fd5b50565b6134f781613407565b811461350257600080fd5b50565b61350e8161341b565b811461351957600080fd5b5056fea2646970667358221220eac164d5e1a389d2f796966d135498c4c397d8c1d1fa5e7e98ab25af16275bbf64736f6c63430006080033";



//
// Create Contract proxy class
let SampleContract = new web3.eth.Contract(abi);
const gasPrice = 1000;//web3.eth.gasPrice;
const gasPriceHex = web3.utils.numberToHex(gasPrice);
const gasLimitHex = web3.utils.numberToHex(4500000);


(async () => {
    const nonceval = await web3.eth.getTransactionCount(account1, "pending"); //'0x' + new Date().getTime();

    console.log(nonceval);

    var fTx = {
        nonce: nonceval,
        gasPrice: gasPriceHex,
        gasLimit: gasLimitHex,
        data: code,
        from: account1
    };

    var txx = new Tx(fTx);
    txx.sign(key1);

    var sTx =txx.serialize();


    const receipt = await web3.eth.sendSignedTransaction('0x' + sTx.toString('hex')).on('receipt', function(receipt){
        console.log(receipt);
    });
})();
